'''
	@Author : Daniel Victor Freire Feitosa
	@Version : 2.0.1
	@DanielFriere00
	YouTube : proxysec
	No-Copyrigths e pau no cu to temer :)
'''
import sys,itertools,os,time,platform

if platform.system() == "Windows":
	os.system("color 0a && cls") # if windows
else:
	os.system("clear") # if linux
print ""
print "  _      _____    _____                      __          "
print "  | | /| / / _ \  / ___/__ ___  ___ _______ _/ /____  ____"
print "  | |/ |/ / // / / (_ / -_) _ \/ -_) __/ _ `/ __/ _ \/ __/"
print "  |__/|__/____/  \___/\__/_//_/\__/_/  \_,_/\__/\___/_/   " 
print ""
print "	                                       by Daniel Freire"                                                                                                                                             

def generator(min_lenght, max_lenght, chars, name):
	try:
		file=open(name, "w")
	except IOError:
		print "\n[x] Error : %s este caminho nao existe\n"%(name)
		sys.exit()
	for n in range(min_lenght, max_lenght + 1):
		for xs in itertools.product(chars, repeat=n):
			string=''.join(xs)
			file.write(string + "\n")
			sys.stdout.write('\r[+] Saving character `%s`' % string)
			sys.stdout.flush()
	file.close()

def generator_param(min_lenght, max_lenght, chars, name, param, value):
	try:
		file=open(name, "w")
	except IOError:
		print "\n[x] Error : %s este caminho nao existe\n"%(name)
		sys.exit()
	for n in range(min_lenght, max_lenght + 1):
		for xs in itertools.product(chars, repeat=n):
			string=''.join(xs)
			if param == "-pre":
				file.write(value+string + "\n")
			elif param == "-pos":
				file.write(string+value + "\n")
			else:
				return 1
			if param == "-pre":
				sys.stdout.write('\r[+] Saving character `%s%s`'%(value,string))
			elif param == "-pos":
				sys.stdout.write('\r[+] Saving character `%s%s`'%(string,value))
			sys.stdout.flush()
	file.close()

if len(sys.argv)>=5:
	try:
		min_lenght=int(sys.argv[1])
		max_lenght=int(sys.argv[2])
		chars=sys.argv[3]
		try:
			param=sys.argv[5]
			try:
				value=sys.argv[6]
			except IndexError:
				print "\n[-] Use wd_generator.py min_length max_length output_file -pre|-pos value"
				print "\n[-] Exemplo : wd_generator.py 4 4 wd.txt -pre proxy"
				print "   |-> Saida desse comando : proxy1234 ...\n"
				sys.exit() 
			generator_param(min_lenght, max_lenght, chars, sys.argv[4], param, value)
			print "\n[+] Wordlist created : " + sys.argv[4]
			print ('\n[-] End time: %s' % time.strftime('%H:%M:%S'))
			sys.exit()
		except IndexError:
			pass
		generator(min_lenght, max_lenght, chars, sys.argv[4])
		print "\n[+] Wordlist created : " + sys.argv[4]
		print ('\n[-] End time: %s' % time.strftime('%H:%M:%S'))
		sys.exit()
	except KeyboardInterrupt:
		print "\n[x] Saindo ..."
else:
	print "\n[+] Simple usage : wd_generator.py min_length max_length string output_file\n"
	print "[+] With prefix or postfix : wd_generator.py min_length string output_file -pre|-pos value\n"
