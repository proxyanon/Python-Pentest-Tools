import sys,itertools,os,time

os.system("color 0a && cls") # if windows
#os.system("clear") # if linux
print ""
print "  _      _____    _____                      __          "
print "  | | /| / / _ \  / ___/__ ___  ___ _______ _/ /____  ____"
print "  | |/ |/ / // / / (_ / -_) _ \/ -_) __/ _ `/ __/ _ \/ __/"
print "  |__/|__/____/  \___/\__/_//_/\__/_/  \_,_/\__/\___/_/   " 
print ""
print "	                                       by Daniel Freire"                                                                                                                                             

if len(sys.argv)>=5:
	try:
		min_lenght=int(sys.argv[1])
		max_lenght=int(sys.argv[2])
		chars=sys.argv[3]
		file=open(sys.argv[4], "w")
		for n in range(min_lenght, max_lenght + 1):
			for xs in itertools.product(chars, repeat=n):
				string=''.join(xs)
				file.write(string + "\n")
				sys.stdout.write('\r[+] Saving character `%s`' % string)
				sys.stdout.flush()
		print "\n[+] Wordlist criada : " + sys.argv[4]
		print ('\n[-] End time: %s' % time.strftime('%H:%M:%S'))
		file.close()
	except KeyboardInterrupt:
		print "\n[x] Saindo ..."
else:
	print "\nUso : wd_generator.py min_lenght max_lenght string output_file"